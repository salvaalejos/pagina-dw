{% extends './layout-client.html' %}

{% block customConfig %}
{% endblock %}

{% block customCSS %}
    <!-- SAID AQUI ESTA EL CSS NO HAY FALLA XD -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bubbles.css') }}">
{% endblock %}

{% block content %}
    <!-- ========== BARRA DE NAVEGACIÓN ========== -->
    </head>
<body id="inicio">
     <header class="main-header">
        <div class="container">
           <a href="#" class="logo">
                 <img src="static\images\Logo.png" alt="Logo de Pop Bubbles">
            </a>
            <nav class="main-nav">
                <a href="#inicio">Inicio</a>
                <a href="#menu">Menú</a>
                <a href="#contacto">Contactanos</a>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <section class="content-section">
                <div class="image-container">
                    <img src="static\images\mision-mascota.png" alt="Mascota Guardia de Pop Bubbles">
                </div>
                <div class="text-content">
                    <h2 class="section-title">Misión</h2>
                    <p>
                        Ser la marca de referencia en bebidas frappe con boba, ofreciendo una experiencia de sabor única y refrescante. Nos comprometemos a utilizar ingredientes de la más alta calidad, priorizando la innovación en nuestros sabores y la satisfacción de nuestros clientes en cada sorbo. Buscamos crear un ambiente vibrante y acogedor donde la gente pueda disfrutar de un momento delicioso y energizante.
                    </p>
                </div>
            </section>

            <section class="content-section">
                <div class="image-container">
                    <img src="static\images\vision-mascota.png" alt="Mascota de Pop Bubbles">
                </div>
                <div class="text-content">
                    <h2 class="section-title">Visión</h2>
                    <p>
                        Expandir nuestra marca para ser reconocida a nivel nacional como el destino predilecto para los amantes de las bebidas frappe y el té de burbujas. Seremos pioneros en la creación de sabores y texturas emocionantes, estableciendo un estándar de excelencia en la calidad del producto y el servicio al cliente. Soñamos con que nuestra boba sea sinónimo de felicidad, innovación y el placer de un antojo perfecto.
                    </p>
                </div>
            </section>
            
            <section class="content-section">
                <div class="image-container">
                     <img src="static\images\historia-mascota.png" alt="Vaso de Pop Bubbles">
                </div>
                <div class="text-content">
                    <h2 class="section-title">Nuestra historia</h2>
                    <p>
                        La marca "POPS BUBBLES TEA" es pionera en Morelia, pues desde el año 2010 comenzó a incluir las bolitas de tapioca en las bebidas.
                        <br><br>
                        Contamos con una amplia variedad de sabores que dan más de un millón de combinaciones, somos únicos y naturales nuestras pulpas son preparadas con la más sabrosa pulpa natural así cada sorbo es una explosión de frescura Y que lo convierten en una experiencia única, divertida y original Además que ofrecemos opciones de personalización tan únicas como tú lo puedas querer y hacer posible.
                        <br><br>
                        Atrevete a probar cada sabor y combinación existente en bubbles y descubre por qué es mucho más que una bebida, cada vez que lo pruebes descubrirás una experiencia refres- cante que estimulará tus sentidos y se grabará en tu memoria!!!
                    </p>
                </div>
            </section>
        </div>
    </main>

    <section id="menu" class="fade-in-section">
            <div class="container">
                <div class="text-content" style="text-align: center; margin-bottom: 3rem;">
                    <h2 class="section-title">Nuestro Menú</h2>
                </div>
                
                <div class="card">
                    <div class="form-group">
                        <label for="branch-selector" class="form-label" style="text-align:center; font-size: 1.5rem;">Paso 1: ¡Elige tu sucursal! 📍</label>
                        <select id="branch-selector" class="form-select">
                            <option value="" disabled selected>-- Selecciona dónde recoger tu felicidad --</option>
                            {% for sucursal in sucursales %}
                                <option value="{{ sucursal[0] }}">{{ sucursal[1] }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div id="menu-container" class="hidden">
                    <div class="text-content" style="text-align: center; margin-bottom: 3rem;">
                        <h2 class="section-title" style="font-size: 2rem;">Paso 2: Arma tu pedido</h2>
                    </div>
                    <div id="menu-items" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                        </div>
                </div>
            </div>
        </section>

        <section id="contacto" class="fade-in-section">
            <div class="container">
                <div class="text-content" style="text-align: center; margin-bottom: 3rem;">
                    <h2 class="section-title">¡Contáctanos!</h2>
                    <p style="max-width: 600px; margin: 1rem auto 0;">¿Tienes una idea, un antojo o una duda? Nos encantaría escucharte.</p>
                </div>

                <div class="card">
                    <form id="contact-form" action="/add-comments" method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <div class="form-group">
                            <label for="name" class="form-label">Nombre Completo</label>
                            <input type="text" id="name" name="name" placeholder="Tu nombre aquí" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="email" class="form-label">Correo Electrónico</label>
                            <input type="email" id="email" name="email" placeholder="tu@correo.com" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="message" class="form-label">Mensaje</label>
                            <textarea id="message" name="message" rows="5" placeholder="Cuéntanos cómo podemos ayudarte..." class="form-textarea" required></textarea>
                        </div>
                        <div style="text-align: center; margin-top: 2rem;">
                            <button type="submit" class="btn btn-primary">Enviar Mensaje</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <script>
    const allDrinks = {{ drinks|tojson }};

    document.addEventListener('DOMContentLoaded', () => {
        const branchSelector = document.getElementById('branch-selector');
        const menuContainer = document.getElementById('menu-container');
        const menuItemsContainer = document.getElementById('menu-items');

        branchSelector.addEventListener('change', function() {
            const selectedBranchId = this.value;

            if (!selectedBranchId) {
                menuContainer.classList.add('hidden');
                return;
            }

            const filteredDrinks = allDrinks.filter(drink => drink[5] == selectedBranchId);

            menuItemsContainer.innerHTML = '';

            if (filteredDrinks.length > 0) {
                const menuHtml = filteredDrinks.map((drink, index) => `
                    <div class="bg-white rounded-3xl shadow-xl overflow-hidden 
                                 transform hover:scale-[1.03] transition-all duration-300 
                                 border border-gray-100 menu-item-card" style="animation-delay: ${index * 0.1}s;">
                        <img src="${drink[4]}" alt="Imagen de ${drink[1]}" 
                             class="w-full object-cover rounded-t-3xl" style="height: 180px;">
                        <div class="p-6">
                            <h4 class="text-2xl font-bold text-emerald-800 mb-2">${drink[1]}</h4>
                            <p class="text-gray-500 mb-4 text-sm line-clamp-2">${drink[3]}</p>
                            <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                                <span class="text-2xl font-extrabold text-red-500">$${parseFloat(drink[2]).toFixed(2)}</span>
                                <button class="add-to-cart-btn 
                                               bg-emerald-500 hover:bg-emerald-600 text-white 
                                               font-semibold py-2 px-4 rounded-full 
                                               shadow-md hover:shadow-lg transition-all duration-200 
                                               flex items-center gap-2 text-sm" 
                                        data-id="${drink[0]}">
                                    <i data-lucide="plus" class="w-5 h-5"></i>
                                    Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');

                menuItemsContainer.innerHTML = menuHtml;

            } else {
                menuItemsContainer.innerHTML = '<p class="text-gray-500 col-span-full text-center">Lo sentimos, no hay productos disponibles en esta sucursal.</p>';
            }

            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });

        // Este código es para el carrito (abrir/cerrar)
        const cartButton = document.getElementById('cart-button');
        const closeCartButton = document.getElementById('close-cart-button');
        const cartSidebar = document.getElementById('cart-sidebar');
        const cartOverlay = document.getElementById('cart-overlay');

        function toggleCart() {
            cartSidebar.classList.toggle('translate-x-full');
            cartOverlay.classList.toggle('hidden');
        }

        cartButton.addEventListener('click', toggleCart);
        closeCartButton.addEventListener('click', toggleCart);
        cartOverlay.addEventListener('click', toggleCart); // Cierra el carrito al hacer clic fuera
    });

    // Script para animar la entrada de las secciones al hacer scroll
const fadeInSections = document.querySelectorAll('.fade-in-section');

const observerOptions = {
    root: null,
    rootMargin: '0px',
    threshold: 0.1 // Porcentaje de la sección visible para activar la animación
};

const sectionObserver = new IntersectionObserver((entries, observer) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            observer.unobserve(entry.target); // Dejar de observar una vez animada
        }
    });
}, observerOptions);

fadeInSections.forEach(section => {
    sectionObserver.observe(section);
});

// Actualización del contador del carrito para mostrar/ocultar
const updateCartCount = () => {
    const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
    const cartCountElement = document.getElementById('cart-count');
    if (cartItems.length > 0) {
        cartCountElement.textContent = cartItems.length;
        cartCountElement.classList.remove('hidden');
    } else {
        cartCountElement.classList.add('hidden');
    }
};

updateCartCount(); // Llama al inicio para asegurar el estado correcto
</script>


{% endblock %}


